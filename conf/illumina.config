// Illumina specific params

params {
    // Repo to download your artic scripts from
    scriptsRepoURL = 'https://github.com/artic-network/fieldbioinformatics.git'

    // Directory within scriptsRepoURL that contains scripts
    scriptsDir = 'artic'

    // illumina fastq search path
    illuminaSuffixes = ['*_R{1,2}_001', '*_R{1,2}', '*_{1,2}' ]
    fastq_exts = ['.fastq.gz', '.fq.gz']

    fastqSearchPath = makeFastqSearchPath( params.illuminaSuffixes, params.fastq_exts )

    // Allow reads that don't have primer sequence? Ligation prep = false, nextera = true
    allowNoprimer = true

    // Length of illumina reads to keep after primer trimming
    illuminaKeepLen = 20

    // Sliding window quality threshold for keeping reads after primer trimming (illumina)
    illuminaQualThreshold = 20

    // Mpileup depth for ivar
    mpileupDepth = 100000

    // iVar frequency threshold for consensus variant (ivar consensus: -t)
    ivarFreqThreshold = 0.75

    // Minimum coverage depth to call variant (ivar consensus: -m; ivar variants -m)
    ivarMinDepth = 10

    // iVar frequency threshold to call variant (ivar variants: -t )
    ivarMinFreqThreshold = 0.25

    // iVar minimum mapQ to call variant (ivar variants: -q)
    ivarMinVariantQuality = 20
    
    // lofreq minimum base quality to call variant (lofreq call: --min-bq)
    lofreqMinBaseQuality = 10

    // lofreq minimum mapQ to call variant (lofreq call: --min-mq)
    lofreqMinMapQuality = 20

    // lofreq minimum coverage to call variant (lofreq call: --min-cov)
    lofreqMinCov = 1

    // coverage threshold below which bases are set to N (make_depth_mask.py --depth)
    minDepthThreshold = 20

}

def makeFastqSearchPath ( illuminaSuffixes, fastq_exts ) {
    if (! params.directory ) {
        println("Please supply a directory containing fastqs with --directory")
        System.exit(1)
    }

    def fastq_searchpath = []
    for (item in illuminaSuffixes){
        for(thing in fastq_exts){
            fastq_searchpath.add(params.directory.toString() + '/**' + item.toString() + thing.toString())
        }
    }
    return fastq_searchpath
}